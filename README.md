# BMP 이미지 그레이스케일 변환 및 MEM 파일 생성 소프트웨어
<img width="315" height="315" alt="brainct_001" src="https://github.com/user-attachments/assets/8d03445f-322d-4cc2-9d90-251370a270b4" />


## 문서 관리 정보
 - 문서 ID: BMP-DO178C-002
 - 버전: 1.1 / 날짜: 2025년 8월 29일
 - 분류: 설계 보증 레벨 D (DAL-D)
 - 시스템: 의료용 반도체 검증 환경용

### 1. 소프트웨어 인증 계획서 (PSAC)
#### 1.1 소프트웨어 개요
 - 소프트웨어 항목: BMP 그레이스케일 변환 및 MEM 파일 생성기
 - 기능: 의료용 반도체 시스템용 24비트 컬러 BMP 이미지를 8비트 그레이스케일로 변환하고, Verilog 시뮬레이션용 16진수 텍스트(.mem) 파일을 생성함.
 - 중요도 레벨: DAL-D (경미한 고장 상황)

#### 1.2 소프트웨어 생명주기 프로세스
 - 계획 수립 프로세스
 - 소프트웨어 개발 프로세스
 - 소프트웨어 검증 프로세스
 - 소프트웨어 형상관리 프로세스
 - 소프트웨어 품질보증 프로세스

#### 1.3 소프트웨어 생명주기 데이터

### 2. 소프트웨어 요구사항 표준 (SRS)
#### 2.1 상위레벨 요구사항
 * HLR-001 : 이미지 형식 검증
   * 소프트웨어는 입력 파일이 24비트 BMP 형식임을 검증해야 한다.
   * 소프트웨어는 이미지 크기가 630x630 픽셀임을 확인해야 한다.
   * 소프트웨어는 유효하지 않은 파일 형식을 적절한 오류 메시지와 함께 거부해야 한다.

 * HLR-002 : 색공간 변환
   * 소프트웨어는 표준 휘도 공식을 사용하여 RGB 픽셀을 그레이스케일로 변환해야 한다:
   * $Y = 0.299R + 0.587G + 0.114*B$
   * 변환 과정에서 픽셀의 공간적 관계를 유지해야 한다.
   * 출력 값은 0-255 범위 내에 있어야 한다.

 * HLR-003 : 출력 파일 생성 (BMP)
   * 소프트웨어는 8비트 그레이스케일 BMP 파일을 생성해야 한다.
   * 소프트웨어는 256색 그레이스케일 팔레트를 포함해야 한다.
   * 출력 파일은 BMP 표준을 준수해야 한다.

 * HLR-004 : 출력 파일 생성 (MEM)
   * 소프트웨어는 그레이스케일 픽셀 데이터를 Verilog 시뮬레이션용 16진수 텍스트 파일(.mem)로 출력해야 한다.

 * HLR-005 : 메모리 관리
   * 소프트웨어는 동적 메모리 할당 실패를 감지하고 처리해야 한다.
   * 소프트웨어는 할당된 모든 메모리를 적절히 해제해야 한다.
   * 메모리 누수가 발생하지 않아야 한다.

 * HLR-006 : 오류 처리
   * 소프트웨어는 파일 입출력 오류를 감지하고 보고해야 한다.
   * 소프트웨어는 비정상 종료 시 리소스를 정리해야 한다.
   * 모든 오류 상황에 대해 명확한 메시지를 제공해야 한다.

#### 2.2 저수준 요구사항
 * LLR-001 : BMP 헤더 검증
   * 파일 시그니처가 0x4D42 ("BM")인지 확인
   * bitCount 필드가 24인지 검증
   * width와 height가 각각 630인지 확인
 * LLR-002 : 픽셀 데이터 읽기
   * BMP 픽셀 데이터를 하단부터 상단 순으로 읽기
   * 각 행의 패딩 바이트 처리
   * RGB 구조체로 픽셀 데이터 저장
 * LLR-003 : 그레이스케일 변환 알고리즘
   * 각 픽셀에 대해 Y = 0.299*R + 0.587*G + 0.114*B 공식 적용
   * 결과를 uint8_t 형으로 캐스팅
   * 변환된 값을 별도 배열에 저장
 * LLR-004 : 출력 BMP 생성
   * 8비트 BMP용 헤더 구조 생성
   * 256색 그레이스케일 팔레트 작성
   * 그레이스케일 데이터를 하단부터 상단 순으로 출력
 * LLR-005 : 출력 MEM 생성
   * 각 픽셀의 8비트 그레이스케일 값을 2자리 16진수 텍스트로 변환한다.
   * 변환된 16진수 값을 한 줄에 하나씩 `output_image.mem` 파일에 저장한다.

### 3. 소프트웨어 설계 표준 (SDS)
#### 3.1 아키텍처 설계
   * 모듈 구조:
~~~
BMP_Processor
├─── File_Handler
│  ├─── Input_Validator
│  └─── Output_Generator  (BMP and MEM file output)
├─── Image_Processor
│  ├─── Color__Converter
│  └─── Memory__Manager
└─── Error_Handler
~~~

#### 3.2 상세 설계
 * 구조체 정의:
   * BMPFileHeader: BMP 파일 헤더 정보
   * BMPInfoHeader: BMP 정보 헤더
   * RGB: 24비트 RGB 픽셀 데이터
 * 주요 함수:
   * main() : 메인 프로세스 제어
   * rgbToGrayscale() : RGB-그레이스케일 변환
 * 파일 I/O 처리 루틴
 * 메모리 할당/해제 루틴

#### 3.3 인터페이스 설계
 * 입력 인터페이스:
   * 파일명: "brainct_001.bmp"
   * 형식: 24비트 컬러 BMP
   * 크기: 630x630 픽셀
 * 출력 인터페이스:
   * 파일명 1: "output_grayscale.bmp"
   * 형식: 8비트 그레이스케일 BMP
   * 파일명 2: "output_image.mem"
   * 형식: 16진수 텍스트

### 5. 소프트웨어 검증 계획 (SVP)
#### 5.3 테스트 케이스
 * TC-001 : 정상 입력 처리
   * 유효한 630x630 24비트 BMP 파일 입력
   * 예상 결과: 성공적인 그레이스케일 변환 및 BMP, MEM 파일 출력
 * TC-002 : 잘못된 파일 형식
   * 비BMP 파일 입력
   * 예상 결과: 오류 메시지 출력 및 프로그램 종료
 * TC-003 : 잘못된 이미지 크기
   * 630x630이 아닌 BMP 파일 입력
   * 예상 결과: 크기 오류 메시지 출력
 * TC-004 : 메모리 부족 상황
   * 메모리 할당 실패 시뮬레이션
   * 예상 결과: 적절한 오류 처리 및 리소스 정리
 * TC-005 : 파일 I/O 오류
   * 읽기/쓰기 권한 없는 파일 처리
   * 예상 결과: I/O 오류 메시지 출력
 * TC-006 : MEM 파일 내용 검증
   * 생성된 `output_image.mem` 파일의 내용이 변환된 그레이스케일 픽셀 데이터와 일치하는지 확인

### 7. 추적성 매트릭스

 | 요구사항 ID |  설계 요소 | 코드 구현 | 테스트 케이스 |
 |-----|-----|-----|-----|
 | HLR-001 | File_Validator | fread(), 헤더 검증 | TC-001, TC-002, TC-003 |
 | HLR-002 | Color_Converter | rgbToGrayscale() | TC-001 |
 | HLR-003 | Output_Generator | BMP 생성 루틴 | TC-001 |
 | HLR-004 | Output_Generator | MEM 생성 루틴 | TC-001, TC-006 |
 | HLR-005 | Memory_Manager | malloc(), free() | TC-004 |
 | HLR-006 | Error_Handler | 오류 처리 루틴 | TC-002~TC-005 |

 ### 8. 인증 결론
   * 본 BMP 그레이스케일 변환 소프트웨어는 DO-178C DAL-D 수준의 요구사항을 충족하도록 설계 및 구현되었습 니다.
   * 모든 필수 문서가 작성되었으며, 계획된 검증 활동을 통해 소프트웨어의 안전성과 신뢰성이 입증될 것입니 다.

## 승인:
   * 개발팀장: ________________
   * 품질보증 관리자: ________________
   * 인증 담당자: ________________
날짜:
2025년 8월 29일
